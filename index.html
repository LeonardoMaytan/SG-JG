<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Descargas - Semana de Gesti√≥n</title>
  <style>
    :root{ --accent:#0d6efd; font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial }
    body{ margin:0; background:#f6f7fb; color:#111 }
    header{ background:var(--accent); color:#fff; padding:1rem; text-align:center }
    header h1{ margin:0; font-size:1.25rem }
    .container{ max-width:1000px; margin:20px auto; padding:16px }
    .list{ display:grid; gap:10px }
    .item{ display:flex; align-items:center; justify-content:space-between; background:#fff; padding:12px; border-radius:8px;
          box-shadow:0 1px 3px rgba(0,0,0,0.06) }
    .meta{ display:flex; gap:12px; align-items:center }
    .icon{ width:44px; height:44px; border-radius:8px; display:flex; align-items:center; justify-content:center;
           background:#eef2ff; color:var(--accent); font-weight:700 }
    .name{ font-weight:600 }
    .actions{ display:flex; gap:8px; align-items:center }
    .btn{ background:var(--accent); color:white; border:0; padding:8px 12px; border-radius:8px; text-decoration:none; cursor:pointer }
    .btn.secondary{ background:#6c757d }
    .note{ font-size:0.9rem; color:#555; margin-top:12px }
    .small{ font-size:0.85rem; color:#666 }
    footer{ text-align:center; color:#666; margin:28px 0 60px 0 }
    @media (max-width:720px){
      .item{ flex-direction:column; align-items:flex-start; gap:8px }
      .actions{ width:100%; display:flex; justify-content:space-between }
    }
  </style>
</head>
<body>
  <header>
    <h1>üìÅ Descargas ‚Äî Semana de Gesti√≥n</h1>
  </header>

  <main class="container">
    <div class="small">Haz clic en <strong>Descargar (.xlsx)</strong> para bajar el archivo directamente. Si la descarga no funciona revisa los permisos en Google Drive (Cualquiera con el enlace ‚Äî Lector).</div>

    <div id="list" class="list" aria-live="polite"></div>

    <p class="note">Consejo: si prefieres PDF, cambia <code>format=xlsx</code> por <code>format=pdf</code> dentro del script (o p√≠deme que lo haga).</p>
  </main>

  <footer>Creado por Leonardo ¬∑ P√°gina est√°tica compatible con GitHub Pages</footer>

  <script>
    // === TU LISTA (exactamente la que compartiste) ===
    const files = [
      {name: 'Asistencia Entrada Semana de Gesti√≥n -  D√≠a 4 Lunes.xlsx', file: 'https://docs.google.com/spreadsheets/d/17SpwusAmuCqsXH7O2nnEkxcHqhUl5Qcq/preview'},
      {name: 'Asistencia Salida Semana de Gesti√≥n -  D√≠a 4 Lunes.xlsx', file: 'https://docs.google.com/spreadsheets/d/1P84ePAjbgTCu7EjMy9jJlxrgZIbEOiAu/preview'},
      {name: 'EVIDENCIAS - D√çA 4 LUNES.xlsx', file: 'https://docs.google.com/spreadsheets/d/1AzkpgYDuf25E9ESnA1lgWMUbZqSqb5e1/preview'},
      {name: 'Asistencia Entrada Semana de Gesti√≥n -  D√≠a 5 Martes.xlsx', file: 'https://docs.google.com/spreadsheets/d/1y5zP1axn-VQM3cazyP1TDyOV_ci_WY-R/preview'},
      {name: 'Asistencia Salida Semana de Gesti√≥n -  D√≠a 5 Martes.xlsx', file: 'https://docs.google.com/spreadsheets/d/1bBlMdesIMNcFSOSZUUgy0lIa5aD512zH/preview'},
      {name: 'EVIDENCIAS - D√çA 5 MARTES.xlsx', file: 'https://docs.google.com/spreadsheets/d/1aeLmBhT2DxfO5TN32q8178r3t6KCSu8Y/preview'},
      {name: 'Asistencia Entrada Semana de Gesti√≥n -  D√≠a 7 Jueves.xlsx', file: 'https://docs.google.com/spreadsheets/d/1hP6QP-gHTHKc05osKS2dT5P5bFSFwyGp/preview'},
      {name: 'Asistencia Salida Semana de Gesti√≥n -  D√≠a 7 Jueves.xlsx', file: 'https://docs.google.com/spreadsheets/d/1Zc4iSzLmZMHyLIu_cS3ljH24d0qTfeeZ/preview'},
      {name: 'EVIDENCIAS - D√çA 7 JUEVES.xlsx', file: 'https://docs.google.com/spreadsheets/d/1SO_kqGF0PwyI_7qqg8pakvmeDOWGA9JZ/preview'},
      {name: 'Asistencia Entrada Semana de Gesti√≥n -  D√≠a 8 Viernes.xlsx', file: 'https://docs.google.com/spreadsheets/d/1hsVsFve3oKUZqcJ7_4MouvIns69pmQpP/preview'},
      {name: 'Asistencia Salida Semana de Gesti√≥n -  D√≠a 8 Viernes.xlsx', file: 'https://docs.google.com/spreadsheets/d/10OLk7RHzlndimYcnpq2ta4l_Ueumt-2Y/preview'},
      {name: 'EVIDENCIAS - D√çA 8 VIERNES.xlsx', file: 'https://docs.google.com/spreadsheets/d/1qKfKrO5FgP9P6Zs4KpqSJzC3JovAv3vV/preview'}
    ];

    // === Util: extraer ID de URL de Google Drive
    function extractDriveId(url){
      try{
        // busca /d/ID/ patr√≥n
        const m = url.match(/\/d\/([a-zA-Z0-9_-]+)/);
        if(m && m[1]) return m[1];
        // si el enlace es el formato sharepoint? attempt another common format: id=...
        const q = url.match(/[?&]id=([a-zA-Z0-9_-]+)/);
        if(q && q[1]) return q[1];
        return null;
      }catch(e){
        return null;
      }
    }

    // Construye URL de exportaci√≥n (descarga directa) para Google Sheets
    // tipo: 'xlsx' o 'pdf' -> modifica si necesitas otro formato
    function buildExportUrl(rawUrl, type = 'xlsx'){
      const id = extractDriveId(rawUrl);
      if(!id) return null;
      // Para Google Sheets -> export?format=xlsx
      return `https://docs.google.com/spreadsheets/d/${id}/export?format=${encodeURIComponent(type)}`;
    }

    // Render lista con bot√≥n de descarga
    const listEl = document.getElementById('list');

    files.forEach((f, idx) => {
      const item = document.createElement('div');
      item.className = 'item';

      const meta = document.createElement('div');
      meta.className = 'meta';
      const icon = document.createElement('div');
      icon.className = 'icon';
      icon.textContent = 'XLSX';
      const name = document.createElement('div');
      name.className = 'name';
      name.textContent = `${idx+1}. ${f.name}`;
      meta.appendChild(icon);
      meta.appendChild(name);

      const actions = document.createElement('div');
      actions.className = 'actions';

      // construir URL de descarga
      const dlUrl = buildExportUrl(f.file, 'xlsx');

      if(dlUrl){
        const a = document.createElement('a');
        a.className = 'btn';
        a.href = dlUrl;
        a.setAttribute('aria-label', `Descargar ${f.name}`);
        // no garantizamos que download funcione con Google Drive, pero este enlace iniciar√° la descarga
        a.textContent = 'üì• Descargar (.xlsx)';
        a.target = '_blank';
        actions.appendChild(a);
      } else {
        const warn = document.createElement('div');
        warn.className = 'small';
        warn.textContent = 'Enlace inv√°lido ‚Äî revisar';
        actions.appendChild(warn);
      }

      // A√±adir opci√≥n para abrir el enlace original en nueva pesta√±a (si quieres)
      const view = document.createElement('a');
      view.className = 'btn secondary';
      view.href = f.file;
      view.target = '_blank';
      view.textContent = 'üîó Ver';
      actions.appendChild(view);

      item.appendChild(meta);
      item.appendChild(actions);
      listEl.appendChild(item);
    });

  </script>
</body>
</html>

